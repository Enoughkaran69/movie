<!DOCTYPE html>
<html>
<head>
  <title>Playing</title>
  <script type="text/javascript" src="https://ssl.p.jwpcdn.com/player/v/8.36.3/jwplayer.js"></script>
</head>
<body>

<div id="my-video-player" style="width: 640px; height: 360px;"></div>
    <p id="video-id-display"></p>

<script type="text/javascript">
    function getQueryParams() {
        const params = new URLSearchParams(window.location.search);
        return params.get('id');
    }

    function setCookie(name, value, days) {
        const date = new Date();
        date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000); // Convert days to milliseconds
        const expires = `expires=${date.toUTCString()}`;
        document.cookie = `${name}=${value}; ${expires}; path=/; Secure`;
    }

    const id = getQueryParams();
    const hValue = localStorage.getItem('t_hash_t') || '';
    const hhValue = hValue.includes('su') ? hValue.replace('su', 'ni') : hValue;
  

    // Set cookies
    setCookie('t_hash_t', hhValue, 1); // Expires in 1 day
        // Display id in HTML
      if (id) {
          document.getElementById('video-id-display').innerText = `Video ID: ${id}`;
      } else {
          document.getElementById('video-id-display').innerText = 'Video ID is missing in the URL.';
          console.error('Video ID is missing in the URL.');
      }


    if (!id) {
        console.error('Video ID is missing in the URL.');
    } else {
        const vid = `https://cors.karankingrider.workers.dev/?url=https://iosmirror.cc/hls/${encodeURIComponent(id)}.m3u8?in=${encodeURIComponent(hhValue)}`;
        const img = `https://imgcdn.media/poster/1920/${encodeURIComponent(id)}.jpg`;

        var jwDefaults = {
  "autostart": "viewable",
  "controls": true,
  "defaultBandwidthEstimate": 10000,
  //"displaydescription": true,
  //"displaytitle": true,
 // "flashplayer": "//ssl.p.jwpcdn.com/player/v/8.13.1/jwplayer.flash.swf",
  "key": "c6Wt+3BVVfc9af5UKM76pP5Vxu+Tu55CBvqMZGg3pEc=",
  //"mute": false,
 // "ph": 2,
 // "pid": "DEFAULT0",
  //"aspectratio": "5:4",
  "preload": "auto",
  //"repeat": false,
  "skin": {
"controlbar": {
"background": "rgba(245, 245, 245, 0)",
"icons": "#ffffff",
"iconsActive": "rgb(244, 129, 129)"
},
"timeslider": {
"progress": "rgba(253, 0, 0)",
"rail": "rgba(247, 244, 244, 0.40)",
"buffer": "rgb(255, 255, 255)"
},
"tooltips": {
//"background": "rgba(0, 0, 0)",
//"text": "#FFFFFF"
}},
  //"stagevideo": false,
  "stretching": "fill",
  "width": "100%",
  "height": "100%",
  "pipIcon":"disabled"
  
};
//jwplayer.defaults = jwDefaults;
 

        jwplayer("my-video-player").setup({
            file: vid, // Video file URL
            image: img, // Thumbnail image
            ...jwDefaults
        });
    }
</script>

</body>
</html>
